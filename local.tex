
%%% For proofs 
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem*{remark}{Remark}
\newtheorem{invariant}{Invariant}
\renewcommand\qedsymbol{$\blacksquare$}
\newenvironment{myproof}{{\bf Proof:}}{\hfill\rule{2mm}{2mm}}

\newcommand{\pref}[1]{\prettyref{#1}}
\newcommand{\Pref}[1]{\prettyref{#1} \vpageref[]{#1}}
\newcommand{\ppref}[1]{\vpageref[]{#1}}
\newrefformat{fig}{Figure~\ref{#1}}
\newrefformat{tab}{Table~\ref{#1}}


%%%% For Color
%\definecolor{dark-gray}{gray}{0.2}
%\definecolor{mygreen}{rgb}{0,0.6,0}
%\definecolor{mygray}{rgb}{0.5,0.5,0.5}
%\definecolor{mymauve}{rgb}{0.58,0,0.82}
%\definecolor{myblue}{HTML}{144B7D}

%%%% For the new operator
\DeclareMathOperator*{\bigJoin}{\scalerel*{\Join}{\sum}}

%%% general
\newcommand\ignore[1]{}
\newcommand{\eg}{{\em e.g.}}
\newcommand{\ie}{{\em i.e.}}
\newcommand{\cf}{see }
\newcommand{\etal}{{\em et al.}}
\newcommand{\code}[1]{{\texttt{#1}}}
\newcommand{\codeinmath}[1]{{\mathrm{\texttt{#1}}}}


%%% Names 
\newcommand{\intelmachine}{\mathsf{x86}}
\newcommand{\clight}{\mathsf{clight}}
\newcommand{\compcert}{\mathsf{CompCert}}
\newcommand{\compcertx}{\mathsf{CompCertX}}
\newcommand{\certikos}{\mathsf{CertiKOS}}
\newcommand{\calname}{\mathsf{CAL}}
\newcommand{\ccalname}{\mathsf{CCAL}}
\renewcommand{\coq}{\mathsf{Coq}}
\newcommand{\paxos}{\mathsf{Paxos}}
\newcommand{\raft}{\mathsf{Raft}}
\newcommand{\verdi}{\mathsf{Verdi}}
\newcommand{\selfour}{\mathsf{SeL4}}
\newcommand{\rgsimname}{\mathsf{RGSim}}

\newcommand{\lasm}{\mathsf{LAsm}}
\newcommand{\easm}{\mathsf{EAsm}}
\newcommand{\tasm}{\mathsf{TAsm}}
\newcommand{\hasm}{\mathsf{HAsm}}

%%%%

%
%% COMMENTS 
\newif \ifcomments \commentstrue

\ifcomments
\newcommand{\zhong}[1]{\textbf{\textcolor{red}{[ #1 --Zhong]}}}
\newcommand{\jieung}[1]{\textbf{\textcolor{blue}{[ #1 -- Jieung]}}}

\else
\newcommand{\zhong}[1]{}
\newcommand{\jieung}[1]{}

\fi
%% END COMMENTS
%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%% COMMON 



%%%%%%%%%%%%%% FROM CCAL 

\newcommand\layer[3]{(#1,#2,#3)}

\newcommand\sem[2]{[\![{#1} \langle {#2} \rangle]\!]}
\newcommand\join{\!\bowtie\!}
\newcommand\Refrel{\sqsubseteq}
\newcommand\LSem[1]{\textrm{LSem(}#1\textrm{)}}
\newcommand\ClightX[1]{\textrm{ClightX(}#1\textrm{)}}
\newcommand\CompCertX[1]{\textrm{CompCertX(}#1\textrm{)}}


% Orders on layers and behaviors: \lsim and \lle correspond to QuiverSim,
% whereas \lpath corresponds to CategorySim.
\newcommand{\lle}{\preceq}
\newcommand{\lsim}[1]{\prec_{#1}}
\newcommand{\lpath}[1]{\le_{#1}}
\newcommand{\id}{\textbf{id}}

% Typing judgements
\newcommand{\ltyp}[4]{#1 \vdash_{#2} #3 : #4}
\newcommand{\lltyp}[5]{#2 \vdash^{#1}_{#3} #4 : #5}
\newcommand{\rulename}[1]{\textsc{\smaller{}#1}}

% Useful shorthands used in layer.tex
\newcommand{\kw}[1]{{\mathsf{#1}}} % render as a keyword
\newcommand{\pset}[1]{{\mathcal{P}({#1})}}
\newcommand{\Beh}{\mathsf{Beh}} % the set of behaviors
\newcommand{\Ev}{\mathbb{E}} % the set of events
\newcommand{\Prog}{\mathbb{P}} % a set of programs
\newcommand{\Lang}{\mathbb{L}} % a language with log
\newcommand{\Mach}{\mathbb{M}} % a machine
\newcommand{\Env}{\mathcal{E}} % an environment context
\newcommand{\refines}{\sqsubseteq} % refinement relation
\newcommand{\EC}[1]{{\kw{EC}({#1})}} % encironment
\newcommand\oracle{\mathlarger{\varepsilon}}
\newcommand{\Layer}{\mathcal{L}}
\newcommand{\Rely}{\mathcal{R}}
\newcommand{\Guard}{\mathcal{G}}
\newcommand\abst{\mathcal{A}}
\newcommand\primt{\mathcal{P}}

\tikzset{
  node_w/.style = {circle, fill=white, draw, inner sep=3pt},
  node_b/.style = {circle, fill=lightgray, draw, inner sep=3pt},
  node_d/.style = {circle, double, fill=white, draw, inner sep=3pt},
  node_db/.style = {circle, double, fill=lightgray, draw, inner sep=3pt},
  arc_b/.style = {very thick, draw=red, >={stealth[black]}},
  node_t/.style = {circle, fill=white, draw},
}

%------------------------ Added by OTHERS

\newcommand\step[1]{\overset{#1}{\rightarrow}}
\newcommand\emptye{\epsilon}
\newcommand\model{\models}
\newcommand\opsem[3]{l,ge\model #2 \step{#1} #3}
\newcommand\opsems[3]{l,ge\model #2 \overset{#1}{\rightarrow^*} #3}
\newcommand\partialf{\rightharpoonup}
\newcommand\intp{\rhd}
\newcommand\CAS{\codeinmath{CAS}}
\newcommand\XADD{\codeinmath{XADD}}
\newcommand\XCHL{\codeinmath{XCHL}}
\newcommand\FAA{\codeinmath{FAA}}
\newcommand\FAI{\codeinmath{FAI}}
\newcommand\regs{\rho}
\newcommand\state{s}
\newcommand\cpush{\codeinmath{push}}
\newcommand\cpull{\codeinmath{pull}}
\newcommand\push{\codeinmath{push}}
\newcommand\pull{\codeinmath{pull}}

\newcommand\incticket{\codeinmath{FAI}}
\newcommand\incnow{\codeinmath{inc\_now}}
\newcommand\getnow{\codeinmath{get\_now}}
\newcommand\tshared{\codeinmath{tshared}}
\newcommand\holdlock{\codeinmath{hold}}
\newcommand\lockstatus{\codeinmath{lock\_status}}
\newcommand\true{\codeinmath{true}}
\newcommand\false{\codeinmath{false}}
\newcommand\ccalwaitlock{\codeinmath{wait\_lock}}
\newcommand\releaselock{\codeinmath{release\_lock}}

\newcommand*{\LargerCdot}{\raisebox{0.25ex}{\scalebox{0.7}{$\bullet$}}}
\newcommand\cons{\LargerCdot}
\newcommand\set[1]{\{#1\}}
\newcommand\replay{\mathbb{R}}
\newcommand\calwait{\mathbb{B}}
\newcommand\any{\cdot}
\newcommand\nonev{\_}
\newcommand\spec{\sigma}
\newcommand\integer{\mathbb{N}}


\newcommand\ccalcode{\kappa}
\newcommand\acq{\mathsf{acquire}}
\newcommand\rel{\mathsf{release}}
\newcommand\deq{\mathsf{deQ}}
\newcommand\enq{\mathsf{enQ}}
\newcommand\reach{\mathsf{reachable}}
\newcommand\now{\mathsf{now}}
\newcommand\ticket{\mathsf{ticket}}
\newcommand{\partf}{\rightharpoonup}
\newcommand\bytelist{\textit{bl}}
\newcommand\spawn{\mathsf{spawn}}
\newcommand\yield{\mathsf{yield}}
\newcommand\cyield{\mathsf{cyield}}
\newcommand\sleep{\mathsf{sleep}}
\newcommand\vundef{\mathsf{vundef}}
\newcommand\ofs{\mathsf{ofs}}
\newcommand\wakeup{\mathsf{wakeup}}
\newcommand\regset{rs}
%\newcommand\tid{\mathsf{tid}}
\newcommand\alist{\rightharpoonup}
\newcommand\tid{t}
\newcommand\eempty{\mathsf{empty}}
\newcommand\option{\mathsf{option}}
\newcommand\qloc{\mathsf{q\_loc}}
\newcommand\perm[1]{\mathsf{status}(#1)}
\newcommand\LAsm{\mathsf{LAsm}}
\newcommand\TAsm{L_\mathsf{pthread}}
\newcommand\boot{\mathsf{x86}}
\newcommand\allid{ID}

\newcommand\ssem[2]{\llparenthesis {#2}\langle {#1} \rangle \rrparenthesis}

\newcommand{\strat}[1]{\varphi_{#1}}
\newcommand{\stratp}[1]{\varphi'_{#1}}

%% BEGIN CompCert memory model and extensions
\newcommand{\nextblockOP}[0]{\mathsf{nb}}
\newcommand{\nextblock}[1]{\nextblockOP({#1})}
\newcommand{\liftnextblockOP}[0]{\mathsf{liftnb}}
\newcommand{\liftnextblock}[2]{\liftnextblockOP({#1}, {#2})}
\newcommand{\extends}[2]{{#1} \subseteq {#2}}
\newcommand{\inject}[3]{{#2} \stackrel{#1}{\hookrightarrow} {#3}}
\newcommand{\alloc}[3]{\mathsf{alloc}({#1}, {#2}, {#3})}
\newcommand{\store}[3]{\mathsf{st}({#1}, {#2}, {#3})}
\newcommand{\load}[2]{\mathsf{ld}({#1}, {#2})}
\newcommand{\some}[1]{\left\lfloor {#1} \right\rfloor}

\newcommand{\disjointunionOP}[0]{\circledast}
\newcommand{\disjointunion}[3]{{#1} \disjointunionOP {#2} \simeq {#3}}

\newcommand{\PBoot}{L_\mathsf{x86}}

\newcommand\efrom[1]{(#1\intp)}
\newcommand\eto[1]{(\intp#1)}
\newcommand\ssame{\odot}
\newcommand\sdiff{\triangle}
\newcommand\switch{\!\hookrightarrow\!}
\newcommand\mysout[1]{\text{\sout{$#1$}}}
%\newcommand\PLayer[3]{#1^{#3}[#2]}
\newcommand\PLayer[3]{#1[#2]}
\newcommand\TLayer[3]{#1[#2][#3]}
\newcommand\Query[3]{#1[{#3}, #2]}
\newcommand\Lthread{L_\codeinmath{td}}
\newcommand\Lbthread{L_\codeinmath{btd}}
\newcommand\Lhbthread{L_\codeinmath{hbtd}}
\newcommand\Lhthread{L_\codeinmath{htd}}
\newcommand\Compose[3]{\codeinmath{compat}(#1, #2, #3)}



\newcommand{\sstepr}[5]{#1(#2, #3) \ni (#4, #5)}
\newcommand{\sstep}[4]{#1(#2, #3) \ni (#4)}
\newcommand{\para}[1]{\paragraph{#1}}
\newcommand{\modulef}[1]{#1 \mapsto \kappa_{#1}}

\newcommand{\remove}[1]{\textcolor{red}{\sout{#1}}}
\newcommand{\added}[1]{\textcolor{blue}{#1}}
\newcommand{\return}[0]{\downarrow\!}




%%%%%%%%%%%%%% FROM MCSLOCK
\newcommand{\swaptail}[2]{\texttt{SWAP$\_$TAIL #1 #2}}
\newcommand{\castail}[1]{\texttt{CAS$\_$TAIL #1}}
\newcommand{\getnext}{\texttt{GET$\_$NEXT}}
\newcommand{\setnext}[1]{\texttt{SET$\_$NEXT #1}}
\newcommand{\getbusy}[1]{\texttt{GET$\_$BUSY #1}}
\newcommand{\setbusy}{\texttt{SET$\_$BUSY}}
\newcommand{\invalidmcsval}{\texttt{MCS\_TOTAL\_CPU}}
\newcommand{\rellock}{\texttt{REL$\_$LOCK}}
\newcommand{\waitlock}[1]{\texttt{WAIT$\_$LOCK #1}}
\newcommand{\mcsmboot}{\texttt{MMCSMBoot}}
\newcommand{\mmcslockintro}{\texttt{MMCSLockIntro}}
\newcommand{\mmcslockabsintro}{\texttt{MMCSLockAbsIntro}}
\newcommand{\mmcslockop}{\texttt{MMCSLockOp}}
\newcommand{\mqmcslockop}{\texttt{MQMCSLockOp}}
\newcommand{\mhmcslockop}{\texttt{MHMCSLockOp}}
%\newcommand{\mathlarger}[1]{#1}
%\newcommand{\mathsmaller}[1]{#1}

%\newcommand\mimp{M_C}
%\newcommand\mabs{M_A}
%\newcommand\layer[3]{(#1,#2,#3)}
%
%\newcommand\pCTOS{p\CTOS}
%\newcommand\mCTOS{mC2}
%\newcommand\mCTOSbase{\mCTOS{}}
%\newcommand\mCTOShyper{\mCTOS{}-hyp}
%\newcommand\mCTOSringz{\mCTOS{}-rz}
%\newcommand\mCTOSembed{\mCTOS{}-emb}
%
%\newcommand\sem[2]{[\![#2]\!]_{#1}}
%\newcommand\join{\!\bowtie\!}
%\newcommand\Refrel{\sqsubseteq}
%\newcommand\LSem[1]{\textrm{LSem(}#1\textrm{)}}
%\newcommand\ClightX[1]{\textrm{ClightX(}#1\textrm{)}}
%\newcommand\CompCertX[1]{\textrm{CompCertX(}#1\textrm{)}}


\newcommand\None{\mathsf{None}}
\newcommand\Some{\mathsf{Some}}

\newcommand\nil{\mathrm{\texttt{nil}}}
\newcommand\QSCalLock{\mathsmaller{\mathrm{\texttt{QS\_CalLock}}}}
\newcommand\CalBound{\mathsmaller{\mathrm{\texttt{CalBound}}}}
\newcommand\CalWaitGet{\mathsmaller{\mathrm{\texttt{CalWaitGet}}}}
\newcommand\LEMPTY{\mathsmaller{\mathrm{\texttt{LEMPTY}}}}
\newcommand\LHOLD{\mathsmaller{\mathrm{\texttt{LHOLD}}}}

\newcommand\SWAPTAIL{\mathsmaller{\mathrm{\texttt{SWAP\_TAIL}}}}
\newcommand\GETNEXT{\mathsmaller{\mathrm{\texttt{GET\_NEXT}}}}
\newcommand\SETNEXT{\mathsmaller{\mathrm{\texttt{SET\_NEXT}}}}
\newcommand\SETBUSY{\mathsmaller{\mathrm{\texttt{SET\_BUSY}}}}
%\newcommand\true{\mathrm{\texttt{true}}}
%\newcommand\false{\mathrm{\texttt{false}}}



%%%%%%%%%%%%%% FROM MULTICORE AND MULTITHREADED LINKING

\newcommand{\dshare}{\mathsf{sa}}
\newcommand{\dproc}{\mathsf{pa}}
\newcommand{\dsnap}{\mathbb{n}\dproc}
\newcommand{\cpuid}{\mathsf{f_{cpu}}}
\newcommand{\procid}{\mathsf{f_{proc}}}
\newcommand{\blocknum}{\mathsf{nb}}

\newcommand{\lval}{\mathsf{Lval}}
\newcommand{\largs}{\mathsf{Largs}}

\newcommand{\primevunit}[1]{\mathsf{EU_{#1}}}
\newcommand{\yieldbackunit}{\mathsf{yieldBack}}
\newcommand{\SLog}{\mathsf{Log}}
\newcommand{\snapfun}{\mathsf{f_{\dsnap}}}

\newcommand{\Sevent}{\mathsf{Ev}}
\newcommand{\threadfunid}{\mathsf{ident}}
\newcommand{\statecheck}{\mathsf{f}_{\mathcal{C}}}

\newcommand{\updatefun}{\mathcal{SR}}
\newcommand{\haseventfun}{\mathsf{f_{evcheck}}}
\newcommand{\threadstate}{\mathsf{ts}}
\newcommand{\nextblockfun}{\mathsf{f_{\blocknum}}}

\newcommand{\initdproc}{\mathsf{f_{init\_pa}}}
\newcommand{\curthread}{\mathsf{CurID}}
\newcommand{\initregs}{\mathsf{f_{init\_regs}}}
\newcommand{\getenvlog}{\mathsf{\varphi^{\curthread}_{[\mathrm{TAsm}]}}}
\newcommand{\composedata}{\mathcal{CD}_{\mathrm{init}}}
\newcommand{\threadset}{\mathsf{T}}
\newcommand{\fullthreadset}{\mathsf{T}_{\mathrm{c}}}

%\newcommand{\AsmLM}{\mathsf{Asm}_{\mathrm{L}}}
\newcommand{\AsmLM}{\mathsf{Asm}}
\newcommand{\AsmHM}{\mathsf{Asm}^{\mathrm{t}}}
\newcommand{\simrel}{\mathcal{R}_{\mathrm{sim}}}
\newcommand{\absrel}{\mathcal{AR}^{{_{\EAsmM{}}}}_{_{\AsmLM}}}
\newcommand{\absrelt}{\mathcal{AR}^{{_{\AsmHM}}}_{_{\TAsmM{}}}}
\newcommand{\proofcase}[1]{({Case\ }_{\mathrm{#1}})}


\newcommand\Lpthread{L_\codeinmath{pthread}}

%%%% CALCULUS
\newcommand{\listlengthkwd}{{\mathrm{len_{lst}}}}

\newcommand{\listlengthnoeq}[1]{{\listlengthkwd({#1})}}
\newcommand{\listlength}[2]{{\listlengthnoeq{#1} = {#2}}}


\newcommand{\ccbyte}{{\mathrm{\texttt{byte}}}}
\newcommand{\ccbytes}{{\listconstructor{\ccbyte}}}
\newcommand{\ccmem}{{\mathrm{\texttt{mem}}}}
\newcommand{\ccprivatemem}{{\ccmem}_{\mathrm{\texttt{p}}}}
\newcommand{\ccsharedmem}{{\ccmem}_{\mathrm{\texttt{s}}}}
%
%\newcommand{\ccprivatememorycpuid}[1]{{\ccmemory}_{\mathrm{\texttt{cpu}}{#1}}}
%


\newcommand{\ccval}{{\mathrm{\texttt{val}}}}
\newcommand{\ccvalintkwd}[1]{{\mathrm{\texttt{Vint}~{#1}}}}
\newcommand{\ccintval}{{\mathrm{\texttt{val}}_{\mathrm{\texttt{int}}}}}
\newcommand{\ccvalptrkwd}[2]{{\mathrm{\texttt{Vptr}~{#1}~{#2}}}}

\newcommand{\ccvundef}{{\mathrm{\texttt{Vundef}}}}
\newcommand{\ccvint}[1]{{\mathrm{\texttt{Vint}}~{#1}}}
\newcommand{\cpuident}{{\mathrm{ID}_\mathrm{cpu}}}


\newcommand{\ccregisterpc}{{\mathrm{\texttt{PC}}}}
\newcommand{\ccregisterebx}{{\mathrm{\texttt{EBX}}}}
\newcommand{\ccregistereax}{{\mathrm{\texttt{EAX}}}}
\newcommand{\ccregister}{{\mathrm{\texttt{reg}}}}

\newcommand{\ccregisterset}{{\rho}}

\newcommand{\absstatekwd}{{\mathrm{\texttt{a}}}}
\newcommand{\ccprivateabsstate}{{\absstatekwd_{\mathrm{\texttt{p}}}}}
\newcommand{\ccsharedabsstate}{{\absstatekwd_{\mathrm{\texttt{s}}}}}
%\newcommand{\ccprivateabsstatecpuid}[1]{{\absstate_{\mathrm{\texttt{cpu}}{#1}}}}
\newcommand{\ccmemloc}{{\mathrm{\texttt{loc}}}}
\newcommand{\ccmemvallength}{{\mathrm{\texttt{vlen}}}}


\newcommand{\cpueventkwd}{{\mathrm{\texttt{ev}}}_{\mathrm{\texttt{CPU}}}}
\newcommand{\cpulogkwd}{{\mathrm{\texttt{log}}_{\mathrm{\texttt{CPU}}}}}


\newcommand{\replayfunckwd}{{\mathbb{R}_\mathrm{cpu}}}
\newcommand{\replayfuncnoeq}[1]{{\replayfunckwd({#1})}}
\newcommand{\replayfunc}[2]{{\replayfuncnoeq{#1} = {#2}}}

\newcommand{\cpuasminst}{{\mathrm{\texttt{x86instr}}}}
\newcommand{\cpuasmfunc}{{\mathrm{\texttt{Func}_{x86}}}}
\newcommand{\cpuasmmodule}{{\mathrm{\texttt{M}_{x86}}}}
\newcommand{\cpuprivatestate}{{\mathrm{\texttt{pst}}_{\mathrm{\texttt{CPU}}}}}
\newcommand{\cpuprivatestatecon}[3]{{({#1}, {#2}, {#3})}}

\newcommand{\cpuprivatestatepool}{{\mathrm{P}_{\cpuprivatestate}}}
\newcommand{\cpustatekwd}{{\mathrm{\texttt{st}}_{\mathrm{\texttt{CPU}}}}}
\newcommand{\cpustatecon}[4]{{({#1}, {#2}, {#3}, {#4})}}

\newcommand{\primitivespeckwd}{\sigma_{p}}

\newcommand{\cpulayerprimdef}{{\mathcal{L}}}

\newcommand{\cpulayerinvariantkwd}{{\mathcal{I}nv}}

\newcommand{\cpurely}[1]{{\mathcal{R}_{\mathrm{\texttt{cpu}[{#1}]}}}}
\newcommand{\cpuguarantee}[1]{{\mathcal{G}_{\mathrm{\texttt{cpu}[{#1}]}}}}

\newcommand{\cpuenvcontextkwd}{{\varepsilon_{\mathrm{\texttt{cpu}}}}}
\newcommand{\cpuenvcontext}[1]{{\varepsilon_{\mathrm{\texttt{cpu}}}({#1})}}

\newcommand{\cpulayerdefkwd}[1]{{\mathrm{\texttt{L}}[{#1}]}}
\newcommand{\cpulayerdefcon}[4]{{({#1}, {#2}, {#3}, {#4})}}

\newcommand{\cpuglobalenv}{{\mathrm{\texttt{Genv}}}}


%keyword
\newcommand{\compcertkwd}{\textrm{CompCert}}

\newcommand{\ignorechar}{\_}
%\newcommand{\set}[1]{\{#1\}}
%\newcommand{\compcertx}{\textrm{CompCertX}}


%type
\newcommand{\doubleplus}{{+\kern-1.3ex+\kern0.8ex}}
\newcommand{\nattype}{{\mathbb{N}}}
\newcommand{\booltype}{{\mathbb{B}}}
\newcommand{\bfalse}{{\mathrm{false}}}
\newcommand{\btrue}{{\mathrm{true}}}
\newcommand{\toptype}{{\top_{\mathrm{TYPE}}}}
\newcommand{\ztype}{{\mathbb{Z}}}
\newcommand{\optionsome}{{\mathrm{Some}}}
\newcommand{\optionnone}{{\mathrm{None}}}
\newcommand{\nulllist}{{\mathrm{nil}}}
\newcommand{\listcons}[2]{{{#1}::{#2}}}
\newcommand{\listapp}[2]{{{#1}\doubleplus{#2}}}

\newcommand{\listconstructorkwd}{\mathrm{lst}}
\newcommand{\listconstructor}[1]{{\listconstructorkwd \ {#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% for CompCertX
%%%%%%%%%%%
%Inductive eventval: Type :=
%  | EVint: int -> eventval
%  | EVlong: int64 -> eventval
%  | EVfloat: float -> eventval
%  | EVfloatsingle: float -> eventval
%  | EVptr_global: ident -> int -> eventval.
%


%Inductive memory_chunk : Type :=
%  | Mint8signed     (**r 8-bit signed integer *)
%  | Mint8unsigned   (**r 8-bit unsigned integer *)
%  | Mint16signed    (**r 16-bit signed integer *)
%  | Mint16unsigned  (**r 16-bit unsigned integer *)
%  | Mint32          (**r 32-bit integer, or pointer *)
%  | Mint64          (**r 64-bit integer *)
%  | Mfloat32        (**r 32-bit single-precision float *)
%  | Mfloat64.        (**r 64-bit double-precision float *)


%Inductive event: Type :=
%  | Event_syscall: ident -> list eventval -> eventval -> event
%  | Event_vload: memory_chunk -> ident -> int -> eventval -> event
%  | Event_vstore: memory_chunk -> ident -> int -> eventval -> event
%  | Event_annot: ident -> list eventval -> event.
%
%(** The dynamic semantics for programs collect traces of events.
%  Traces are of two kinds: finite (type [trace]) or infinite (type [traceinf]). *)
%
%Definition trace := list event.
%%%%%%%%%

\newcommand{\cceventval}{{\mathrm{\texttt{eventval}}_{cc}}}
\newcommand{\ccevent}{{\mathrm{\texttt{event}}_{cc}}}
\newcommand{\ccevintkwd}{{\mathrm{\texttt{EVint}}}}
\newcommand{\ccevlongkwd}{{\mathrm{\texttt{EVlong}}}}
\newcommand{\ccevfloatkwd}{{\mathrm{\texttt{EVfloat}}}}
\newcommand{\ccevfloatsinglekwd}{{\mathrm{\texttt{EVfloatsingle}}}}
\newcommand{\ccevptrglobalkwd}{{\mathrm{\texttt{EVptr}}\_\mathrm{\texttt{global}}}}

\newcommand{\cctracekwd}{{\mathrm{\texttt{trace}}_{cc}}}
\newcommand{\ccemptytrace}{{\mathrm{E}_0}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% MULTICORE LINKING PART
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5



% syntax 

\newcommand{\privatestate}{{\rho_{mc}}}
\newcommand{\privatestatepool}[1]{{\mathrm{psp}_{[#1]}}}
\newcommand{\sharedpiece}{{\Theta{mc}}}
\newcommand{\atomicevent}{{\mathrm{\textbf{\textit{e}}}_{\mathrm{atom}}}}
\newcommand{\primitiveid}{{\mathrm{ID}_{pr}}}
\newcommand{\atomiceventidentkwd}{{\mathrm{GetID}_{\mathrm{atom}}}}
\newcommand{\atomiceventident}[1]{{\mathrm{GetID}_{\mathrm{atom}}({#1})}}

\newcommand{\coreset}{{\mathbb{S}_{core}}}
\newcommand{\schedid}{{\mathrm{ID}_{sched}}}

\newcommand{\command}{{\mathrm{\textbf{\textit{cmd}}_{mc}}}}
\newcommand{\mcevent}{{\mathrm{\textbf{\textit{ev}}}_{mc}}}
\newcommand{\mclog}{{\mathrm{\textbf{\textit{log}}}_{\mathrm{mc}}}}
\newcommand{\mcoracle}[3]{{\varepsilon_{mc[{#1}, {#2}, {#3}]}}}
\newcommand{\ogetkwd}{{\mathrm{\textbf{oget}}}}
\newcommand{\ogetnoeq}[5]{{\ogetkwd_{[{#1}, {#2}, {#3}]}({#4}, {#5})}}
\newcommand{\oget}[6]{{\ogetnoeq{#1}{#2}{#3}{#4}{#5} = \mathrm{Some} \ {#6}}}


%event and command 
\newcommand{\privatecmdkwd}{{\mathrm{PRIVATE}}}
\newcommand{\atomiccmdkwd}{{\mathrm{ATOMIC}}}
\newcommand{\atomiccmd}[2]{{\atomiccmdkwd\langle{#1}, {#2}\rangle}}
\newcommand{\acqsharedcmdkwd}{{\mathrm{ACQ}\_\mathrm{SHARED}}}
\newcommand{\acqsharedcmd}[1]{{\acqsharedcmdkwd\langle{#1}\rangle}}
\newcommand{\relsharedcmdkwd}{{\mathrm{REL}\_\mathrm{SHARED}}}
\newcommand{\relsharedcmd}[1]{{\relsharedcmdkwd\langle{#1}\rangle}}


\newcommand{\yieldevkwd}{{\mathrm{EYIELD}}}
\newcommand{\yieldev}[1]{{\yieldevkwd\langle{#1}\rangle}}
\newcommand{\yieldbackevkwd}{{\mathrm{EBACK}}}
\newcommand{\yieldbackev}[1]{{\yieldbackevkwd\langle{#1}\rangle}}
\newcommand{\acqevkwd}{{\mathrm{EACQ}}}
\newcommand{\acqev}[2]{{\acqevkwd\langle{#1}, {#2}\rangle}}
\newcommand{\relevkwd}{{\mathrm{EREL}}}
\newcommand{\relev}[3]{{\relevkwd\langle{#1}, {#2}, {#3}\rangle}}
\newcommand{\atomicevkwd}{{\mathrm{EATOMIC}}}
\newcommand{\atomicev}[3]{{\atomicevkwd\langle{#1}, {#2}, {#3}\rangle}}

% semantics 
\newcommand{\mcprop}{{\mathcal{P}}}
\newcommand{\optioncmd}[1]{{\mathrm{option}~{#1}}}

\newcommand{\programcounterkwd}{{\mathrm{\textbf{PC}}}}
\newcommand{\programcounter}[2]{{\programcounterkwd \ {#1} \ {#2}}}
\newcommand{\privatestepkwd}{{{\mathrm{step}_{private}}}}
\newcommand{\privatestep}[3]{{\privatestepkwd \ {#1} \ {#2} \ {#3}}}
\newcommand{\getsharedstepkwd}{{\mathrm{step}_{get}}}
\newcommand{\getsharedstep}[3]{{\getsharedstepkwd \ {#1} \ {#2} \ {#3}}}
\newcommand{\setsharedstepkwd}{{\mathrm{step}_{set}}}
\newcommand{\setsharedstep}[3]{{\setsharedstepkwd \ {#1} \ {#2} \ {#3}}}
\newcommand{\atomicstepkwd}{{\mathrm{step}_{atom}}}
\newcommand{\atomicstep}[6]{{\atomicstepkwd \ {#1} \ {#2} \ {#3} \ {#4} \ {#5} \ {#6}}}
\newcommand{\loggetatomkwd}{{\mathrm{lget}_{atom}}}
\newcommand{\loggetatomnoeq}[2]{{\loggetatomkwd({#1}, {#2})}}
\newcommand{\loggetatom}[3]{{\loggetatomnoeq{#1}{#2} = {#3}}}

% hardware local step related definitions 
\newcommand{\ofreekwd}{{\mathrm{OFREE}}}
\newcommand{\ofreestate}[1]{{\ofreekwd\langle{#1}\rangle}}
\newcommand{\ownkwd}{{\mathrm{OWN}}}
\newcommand{\ownstate}[1]{{\ownkwd\langle{#1}\rangle}}
\newcommand{\ownstatekwd}{{\mathrm{Owner}}}

\newcommand{\hstatekwd}{{\mathrm{hstate}}}
\newcommand{\hstateconkwd}{{\mathrm{HState}}}
\newcommand{\hstate}[3]{{\hstateconkwd \ {#1} \ {#2}\ {#3}}}
\newcommand{\localviewkwd}{{\mathrm{l}\_\mathrm{view}}}
\newcommand{\localviewconkwd}{{\mathrm{LView}}}
\newcommand{\localview}[2]{{\localviewconkwd \ {#1} \ {#2}}}
\newcommand{\calownerkwd}{{\mathrm{CalOwner}}}
\newcommand{\calowner}[3]{{\calownerkwd({#1},{#2})={#3}}}

\newcommand{\hardwarelocalstep}[3]{{\mathrm{step}_{hwlocal} \ {#1}\ {#2}\ {#3}}}

\newcommand{\getpstkwd}{{\mathrm{getPST}}}
\newcommand{\getpstnoeq}[3]{{\getpstkwd_{[{#1}]}~({#2},\ {#3})}}
\newcommand{\getpstsome}[4]{{\getpstnoeq{#1}{#2}{#3} = \optionsome \ {#4}}}
\newcommand{\getpstnone}[3]{{\getpstnoeq{#1}{#2}{#3}   = \optionnone}}

\newcommand{\setpstkwd}{{\mathrm{setPST}}}
\newcommand{\setpstnoeq}[4]{{\setpstkwd_{[{#1}]}~({#2}, \ {#3}, \ {#4})}}
\newcommand{\setpst}[5]{{\setpstnoeq{#1}{#2}{#3}{#4} = {#5}}}


\newcommand{\hardwarestepkwd}{{{\mathrm{hw}_{mc}\_\mathrm{step}}}}
\newcommand{\hardwarestep}[4]{{\hardwarestepkwd~{#1}~{#2}~{#3}~{#4}}}


% for oracle fairness
\newcommand{\timebound}{{\lceil{\mathcal{T}}\rceil}}
\newcommand{\yieldbackfunckwd}{{\mathrm{AbsYBack}}}
\newcommand{\yieldbackfuncnoeq}[5]{{\yieldbackfunckwd_{#1}({#2},{#3},{#4},{#5})}}

\newcommand{\yieldbackfunc}[6]{{\yieldbackfuncnoeq{#1}{#2}{#3}{#4}{#5} = \optionsome\ {#6}}}


% for oracle step
\newcommand{\localstatekwd}{{\mathrm{l}\_\mathrm{state}}}
\newcommand{\localstatepool}[1]{{\mathrm{lsp}_{[#1]}}}
\newcommand{\localstateconkwd}{{\mathrm{LState}}}
\newcommand{\localstate}[2]{{\localstateconkwd~{#1}~{#2}}}

\newcommand{\mcstatekwd}{{\mathrm{state}}}
\newcommand{\mcstateconkwd}{{\mathrm{State}}}
\newcommand{\mcstate}[3]{{\mcstateconkwd \ {#1} \ {#2}\ {#3}}}


\newcommand{\oraclestepkwd}{{{\mathrm{oracle}_{mc}\_\mathrm{step}}}}
\newcommand{\oraclestep}[4]{{\oraclestepkwd~{#1}~{#2}~{#3}~{#4}}}


% for env step

\newcommand{\envstatekwd}{{\mathrm{estate}}}
\newcommand{\envstateconkwd}{{\mathrm{EState}}}
\newcommand{\envstate}[4]{{\envstateconkwd_{[{#1}]}~{#2}~{#3}~{#4}}}
\newcommand{\envstepkwd}{{\mathrm{env}\_\mathrm{step}}}
\newcommand{\envstep}[5]{{\envstepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}
\newcommand{\backidkwd}{{\mathrm{backID}}}
\newcommand{\backid}[3]{{\backidkwd({#1}, {#2}) = {#3}}}

% for single, single big, single big2 step
\newcommand{\singlestatekwd}{{\mathrm{s}\_\mathrm{state}}}
\newcommand{\singlestateconkwd}{{\mathrm{SState}}}
\newcommand{\singlestate}[3]{{\singlestateconkwd~{#1}~{#2}~{#3}}}
\newcommand{\singlestepkwd}{{{\mathrm{single}\_\mathrm{step}}}}
\newcommand{\singlestep}[5]{{\singlestepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}

\newcommand{\singlebigstepkwd}{{\mathrm{single}\_\mathrm{big}\_\mathrm{step}}}
\newcommand{\singlebigstep}[5]{{\singlebigstepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}


\newcommand{\rstatekwd}{{\mathrm{rstate}}}
\newcommand{\rstateconkwd}{{\mathrm{RState}}}
\newcommand{\rstate}[2]{{\rstateconkwd~{#1}~{#2}}}
\newcommand{\singlebigtwostepkwd}{{\mathrm{single}\_\mathrm{big2}\_\mathrm{step}}}
\newcommand{\singlebigtwostep}[5]{{\singlebigtwostepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}

% split step and reorder step

\newcommand{\singlelocalviewkwd}{{\mathrm{s}\_\mathrm{l}\_\mathrm{view}}}
\newcommand{\singlelocalviewconskwd}{{\mathrm{SView}}}
\newcommand{\singlelocalview}[1]{{\singlelocalviewconskwd~{#1}}}
\newcommand{\singlelocalstepkwd}{{\mathrm{single}\_\mathrm{local}\_\mathrm{step}}}
\newcommand{\singlelocalstep}[3]{{\singlelocalstepkwd~{#1}~{#2}~{#3}}}

\newcommand{\singlelogstepkwd}{{\mathrm{single}\_\mathrm{log}\_\mathrm{step}}}
\newcommand{\singlelogstep}[3]{{\singlelogstepkwd~{#1}~{#2}~{#3}}}

\newcommand{\srstatekwd}{{\mathrm{srstate}}}
\newcommand{\srstateconkwd}{{\mathrm{SRState}}}
\newcommand{\srstate}[3]{{\srstateconkwd~{#1}~{#2}~{#3}}}
\newcommand{\singlesplitstepkwd}{{\mathrm{single}\_\mathrm{split}\_\mathrm{step}}}
\newcommand{\singlesplitstep}[5]{{\singlesplitstepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}

\newcommand{\singlereorderstepkwd}{{\mathrm{single}\_\mathrm{reorder}\_\mathrm{step}}}
\newcommand{\singlereorderstep}[5]{{\singlereorderstepkwd_{[{#1}]}~{#2}~{#3}~{#4}~{#5}}}


% separate step

\newcommand{\separateeventkwd}{{\mathrm{\textbf{\textit{sp}}}\_\mathrm{\textbf{\textit{ev}}}}}
\newcommand{\separateacqevkwd}{{\mathrm{SEACQ}}}
\newcommand{\separateacqev}[1]{{\separateacqevkwd\langle{#1}\rangle}}
\newcommand{\separaterelevkwd}{{\mathrm{SEREL}}}
\newcommand{\separaterelev}[2]{{\separaterelevkwd\langle{#1}, {#2}\rangle}}
\newcommand{\separateatomicevkwd}{{\mathrm{SEATOMIC}}}
\newcommand{\separateatomicev}[2]{{\separateatomicevkwd\langle{#1},{#2}\rangle}}

\newcommand{\separatelogtypekwd}{{\mathrm{sp}\_\mathrm{l}\_\mathrm{ty}}}
\newcommand{\separatelogkwd}{{\mathrm{sp}\_\mathrm{l}}}
\newcommand{\separateoraclelogtypekwd}{{\mclog_{\_sp}}}

\newcommand{\spstatekwd}{{\mathrm{sp}\_\mathrm{state}}}
\newcommand{\spstateconkwd}{{\mathrm{SPState}}}
\newcommand{\spstate}[2]{{\spstateconkwd~{#1}~{#2}}}

\newcommand{\separatelogstepkwd}{{\mathrm{sp}\_\mathrm{log}\_{\mathrm{step}}}}
\newcommand{\separatelogstep}[5]{{\separatelogstepkwd~{#1}~{#2}~{#3}~{#4}~{#5}}}

\newcommand{\separateeventtwoeventkwd}{{\mathrm{sp}\_\mathrm{ev}\_2\_\mathrm{ev}}}
\newcommand{\separateeventtwoeventnoeq}[2]{{\separateeventtwoeventkwd({#1}, {#2})}}
\newcommand{\separateeventtwoevent}[3]{\separateeventtwoeventnoeq{#1}{#2} = {#3}}

\newcommand{\separatelogtwologkwd}{{\mathrm{sp}\_\mathrm{log}\_2\_\mathrm{log}}}
\newcommand{\separatelogtwolognoeq}[2]{{\separatelogtwologkwd({#1}, {#2})}}
\newcommand{\separatelogtwolog}[3]{\separatelogtwolognoeq{#1}{#2} = {#3}}

\newcommand{\separateeventtwoidkwd}{{\mathrm{sp}\_\mathrm{ev}\_2\_\mathrm{id}}}
\newcommand{\separateeventtwoidnoeq}[1]{{\separateeventtwoidkwd({#1})}}
\newcommand{\separateeventtwoid}[2]{\separateeventtwoidnoeq{#1}= {#2}}


\newcommand{\acqsharedid}{{\mbox{\textsf{acq}}\_\mbox{shared}}}
\newcommand{\relsharedid}{{\mbox{\textsf{rel}}\_\mbox{shared}}}

\newcommand{\getseplogkwd}{{\mathrm{getSlog}}}
\newcommand{\getseplognoeq}[2]{{\getseplogkwd({#1},{#2})}}
\newcommand{\getseparatelog}[3]{{\getseplognoeq{#1}{#2} = {#3}}}


\newcommand{\setseplogkwd}{{\mathrm{setSlog}}}
\newcommand{\setseplognoeq}[3]{{\setseplogkwd({#1},{#2},{#3})}}
\newcommand{\getseplog}[4]{{\setseplognoeq{#1}{#2}{#3} = {#4}}}

\newcommand{\singleseparatestepkwd}{{\mathrm{single}\_\mathrm{separate}\_\mathrm{step}}}
\newcommand{\singleseparatestep}[5]{{\singleseparatestepkwd_{[#1]}~{#2}~{#3}~{#4}~{#5}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% refinement relations

% generic semantics
\newcommand{\ccplusstepkwd}{{\mathrm{plus}}}
\newcommand{\ccplusstep}[1]{{\ccplusstepkwd~{#1}}}

\newcommand{\ccstarstepkwd}{{\mathrm{star}}}
\newcommand{\ccstarstep}[1]{{\ccstarstepkwd~{#1}}}

% valid log 
\newcommand{\eventsourcefunckwd}{{\mathrm{ev}\_\mathrm{src}}}
\newcommand{\eventsourcefuncnoeq}[1]{{\eventsourcefunckwd({#1})}}
\newcommand{\eventsourcefunc}[2]{{\eventsourcefuncnoeq{#1} = {#2}}}

\newcommand{\eventdesfunckwd}{{\mathrm{ev}\_\mathrm{des}}}
\newcommand{\eventdesfuncnoeq}[1]{{\eventdesfunckwd({#1})}}
\newcommand{\eventdesfunc}[2]{{\eventdesfuncnoeq{#1} = {#2}}}

\newcommand{\getcuridfromlogkwd}{{\mathrm{getCidFromLog}}}
\newcommand{\getcuridfromlognoeq}[2]{{\getcuridfromlogkwd({#1}, {#2})}}
\newcommand{\getcuridfromlog}[3]{{\getcuridfromlognoeq{#1}{#2} = {#3}}}


\newcommand{\validlogcheckkwd}{{\mathrm{valid}\_\mathrm{log}\_\mathrm{check}}}
\newcommand{\validlogcheck}[2]{{\validlogcheckkwd~{#1}~{#2}}}

\newcommand{\validlogkwd}{{\mathrm{valid}\_\mathrm{log}}}
\newcommand{\validlog}[2]{{\validlogkwd~{#1}~{#2}}}

\newcommand{\validoraclekwd}{{\mathrm{valid}\_\mathrm{o}}}
\newcommand{\validoraclenoeq}[3]{\validoraclekwd({#1}, {#2}, {#3})}

%%%% oracle refines hardware

\newcommand{\matchlocalkwd}{{\mathcal{M}_{local}}}
\newcommand{\matchlocal}[4]{{\matchlocalkwd~{#1}~{#2}~{#3}~{#4}}}
\newcommand{\matchstatehstatekwd}{{\mathcal{M}_{[\mathrm{st},\mathrm{hst}]}}}
\newcommand{\matchstatehstate}[2]{{\matchstatehstatekwd~{#1}~{#2}}}

%%%% env refines oracle
\newcommand{\matchestatestatekwd}{{\mathcal{M}_{[\mathrm{est}\langle\coreset\rangle,\mathrm{st}]}}}
\newcommand{\matchestatestate}[2]{{\matchestatestatekwd~{#1}~{#2}}}

%%%% env refines env

\newcommand{\mcmeasurekwd}{{\mathrm{measure}}}
\newcommand{\mcmeasurenoeq}[1]{{\mcmeasurekwd({#1})}}
\newcommand{\mcmeasure}[2]{{\mcmeasurenoeq{#1} = {#2}}}

\newcommand{\mcstatemeasurekwd}{{\mathrm{st}\_\mathrm{measure}}}
\newcommand{\mcstatemeasurenoeq}[2]{{\mcstatemeasurekwd({#1}, {#2})}}
\newcommand{\mcstatemeasure}[3]{{\mcstatemeasurenoeq{#1}{#2} = {#3}}}


\newcommand{\localstepevkwd}{{\mathrm{l}\_\mathrm{step}\_\mathrm{ev}}}
\newcommand{\localstepevnoeq}[1]{{\localstepevkwd({#1})}}
\newcommand{\localstepev}[2]{{\localstepevnoeq{#1} = {#2}}}

\newcommand{\matchestateestatekwd}[1]{{\mathcal{M}_{[\mathrm{est}\langle{#1}\rangle,\mathrm{est}\langle\coreset\rangle]}}}
\newcommand{\matchestateestate}[3]{{\matchestateestatekwd{#1}~{#2}~{#3}}}

%%%% single refines env

\newcommand{\matchsinglestatestatekwd}[1]{{\mathcal{M}_{[\mathrm{sist},\mathrm{est}\langle{#1}\rangle]}}}
\newcommand{\matchsinglestatestate}[3]{{\matchsinglestatestatekwd{#1}~{#2}~{#3}}}

%%%% big refines single
\newcommand{\matchbsstatesstatekwd}{{\mathcal{M}_{[\mathrm{bsist},\mathrm{sist}]}}}
\newcommand{\matchbsstatesstate}[2]{{\matchbsstatesstatekwd~{#1}~{#2}}}

%%%% big2 refines big



\newcommand{\matchrstatesinglestatekwd}{{\mathcal{M}_{[\mathrm{rst},\mathrm{sist}]}}}
\newcommand{\matchrstatesinglestate}[3]{{\matchrstatesinglestatekwd~{#1}~{#2}~{#3}}}

%%%% split refines big2

\newcommand{\matchsrstaterstatekwd}{{\mathcal{M}_{[\mathrm{srst},\mathrm{rst}]}}}
\newcommand{\matchsrstaterstate}[2]{{\matchsrstaterstatekwd~{#1}~{#2}}}

%%%% reorder refines split 

\newcommand{\validcachelogmemberskwd}{{\mathrm{validCacheLMem}}}
\newcommand{\validcachelogmembers}[2]{{\validcachelogmemberskwd~{#1}~{#2}}}
\newcommand{\matchrstatesrstatekwd}{{\mathcal{M}_{[\mathrm{rst},\mathrm{srst}]}}}
\newcommand{\matchrstatesrstate}[2]{{\matchrstatesrstatekwd~{#1}~{#2}}}

%%%% reorder refines reorder

\newcommand{\mcreducelogfunckwd}{{\mathrm{redLog}}}
\newcommand{\mcreducelogfuncnoeq}[1]{{\mcreducelogfunckwd({#1})}}
\newcommand{\mcreducelogfunc}[2]{{\mcreducelogfuncnoeq{#1} = {#2}}}

\newcommand{\matchrrstaterrstaekwd}{{\mathcal{M}_{[\mathrm{rst},\mathrm{rst}]}}}
\newcommand{\matchrrstaterrstae}[2]{{\matchrrstaterrstaekwd~{#1}~{#2}}}

%%%% separate refines reorder


\newcommand{\removecacheeventkwd}{{\mathrm{RmvCEv}}}
\newcommand{\removecacheeventnoeq}[2]{{\removecacheeventkwd({#1}, {#2})}}
\newcommand{\removecacheevent}[3]{{\removecacheeventnoeq{#1}{#2} = {#3}}}

\newcommand{\validlogprimkwd}{{\validlogkwd'}}
\newcommand{\validlogprim}[1]{{\validlogprimkwd~{#1}}}
\newcommand{\validoracleprimkwd}{{\validoraclekwd'}}
\newcommand{\validoracleprim}[2]{{\validoracleprimkwd({#1}, {#2})}}

\newcommand{\mcmatchlogskwd}{{\mathcal{M}_{[\separatelogkwd, \mclog]}}}
\newcommand{\mcmatchlogs}[3]{{\mcmatchlogskwd~{#1}~{#2}~{#3}}}

\newcommand{\matchspstaterstatekwd}{{\mathcal{M}_{[\mathrm{spst},\mathrm{rst}]}}}
\newcommand{\matchspstaterstate}[3]{{\matchspstaterstatekwd~{#1}~{#2}~{#3}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% for linking


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%   MULTITHREADED LINKING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% LANGUAGES




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% REFINEMENT


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% LINKING



%%%%%%% WITNESSPASSING 

%%%% Witness passing related definitions
%\newcommand{\envcontext}{\varepsilon}%
%\newcommand{\layerdef}{\mathcal{L}}
%\newcommand{\relyrule}{\mathcal{R}}
%\newcommand{\guaranteerule}{\mathcal{G}}
%\newcommand{\primid}{id}
%\newcommand{\primspec}[1]{\sigma_{#1}}
%\newcommand{\igchar}{\_}
%\newcommand{\sendpkt}[3]{{#1}.\mathrm{SEND}{[#2]}.{#3}}
%\newcommand{\recvpkt}[3]{{#1}.\mathrm{RECV}{[#2]}.{#3}}
%\newcommand{\witness}{\varpi}
\newcommand{\updatefunc}{\varrho}
%\newcommand{\isquorums}{\mathcal{q}}
%\newcommand{\replay}{\mathbb{R}}

%\newcommand{\packet}{{\mathbb{E}_{net}}}
%\newcommand{\networklog}{{l_{net}}}
%\newcommand{\accsset}{\mathbb{S}_{Ca}}
\newcommand{\voters}{\mathbb{S}_{vtr}}
\newcommand{\propset}{\mathbb{S}_{P}}
\newcommand{\fullset}{\mathbb{S}_{D}}
%\newcommand{\nodeid}{\mathrm{ID}}
%\newcommand{\dsvalue}{\Delta}
\newcommand{\seqnum}{\upsilon}
\newcommand{\termnum}{\rho}
\newcommand{\dstate}{\sigma}
\newcommand{\dobj}{\Sigma}
\newcommand{\gstate}{\Sigma}
\newcommand{\ldrwitness}{{\witness_{ldr}}}
\newcommand{\opwitness}{{\witness_{op}}}

\newcommand{\tplfunction}{\mathcal{T}}
\newcommand{\tplldrfunction}{\tplfunction_{ldr}}
\newcommand{\tplopfunction}{\tplfunction_{op}}
\newcommand{\handlerfunction}{\tplfunction^{A}}
\newcommand{\genericfunction}{\tplfunction^{R}}
\newcommand{\protocolfunction}{\mathcal{G}}
\newcommand{\ldrhfunction}{\handlerfunction_{ldr}}
\newcommand{\ophfunction}{\handlerfunction_{op}}
\newcommand{\ldrfunction}{\genericfunction_{ldr}}
\newcommand{\opfunction}{\genericfunction_{op}}
\newcommand{\gldrfunction}{\protocolfunction_{ldr}}
\newcommand{\gopfunction}{\protocolfunction_{op}}
\newcommand{\sendfunction}{\delta_{snd}}
\newcommand{\recvfunction}{\delta_{rcv}}

%\newcommand{\msg}{\mathrm{msg}}
%\newcommand{\argus}{\mathrm{args}}
\newcommand{\chid}{\mathrm{cid}}

\newcommand{\ldrwcons}{\mathcal{C}_{ldr\witness}}
\newcommand{\opwcons}{\mathcal{C}_{op\witness}}
\newcommand{\conwcons}{\mathcal{C}_{con\witness}}
\newcommand{\sysname}{\textsf{Throne}}

\newcommand\mdoubleplus{\ensuremath{\mathbin{+\mkern-4mu+}}}


\lstset{basicstyle=\small\ttfamily }
